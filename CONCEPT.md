# Dochi - 컨셉 문서

## 정의

Dochi는 개인/팀을 위한 범용 LLM 인터페이스입니다. 여러 기기에 설치된 Dochi 앱들이 클라우드를 통해 하나의 컨텍스트를 공유하며, 각 기기는 독립적으로 동작하면서도 전체가 하나의 시스템처럼 움직입니다.

## 이름

"도치"는 고슴도치에서 따왔습니다. 부르기 쉬운 이름이 필요했습니다.

## 핵심 목표

**나의 AI가 기기와 인터페이스를 넘어 하나로 연결된다.**

- 모든 Dochi 인스턴스가 대등한 피어 — 각자 리더이자 팔로워
- 클라우드가 중간 계층으로서 컨텍스트 동기화, 태스크 분배, 충돌 해소를 담당
- 가족/팀원이 동시에 각자의 기기에서 같은 AI를 사용 가능
- 용도에 맞게 쉽게 특화 — `system.md` 하나로 페르소나 전환

## 설계 원칙

1. **피어 기반 분산** — 모든 디바이스가 독립적으로 동작. 클라우드는 조율자이지 중앙 서버가 아님
2. **쉬운 특화** — 마크다운 파일 편집만으로 페르소나와 동작을 바꿀 수 있음
3. **투명하게** — 오픈소스, 데이터 흐름이 명확
4. **확장 가능하게** — 프로토콜 기반 구조, MCP로 도구 확장

## 아키텍처 비전

```
                 ┌──────────────────────────────┐
                 │    Supabase (조율 계층)        │
                 │  Auth / Context DB /          │
                 │  태스크 큐 / 디바이스 레지스트리  │
                 └──────────────┬───────────────┘
                                │
          ┌─────────────────────┼─────────────────────┐
          │                     │                     │
   ┌──────┴──────┐       ┌─────┴─────┐       ┌──────┴──────┐
   │  집 Mac     │       │ 업무 Mac  │       │  메신저 봇   │
   │  음성비서    │       │ 텍스트/CLI │       │  TG / Slack │
   │  3D 아바타  │  ←→   │ MCP 도구  │  ←→   │  팀 채널    │
   │  알람/TTS   │       │ 에이전트   │       │  알림       │
   └─────────────┘       └───────────┘       └─────────────┘
        피어                  피어                  피어
```

### 피어 모델

모든 Dochi 인스턴스는 대등합니다:
- 각 기기가 독립적으로 LLM 호출, 도구 실행, 음성 인터랙션 수행
- 클라우드는 컨텍스트 동기화와 태스크 조율만 담당
- 한 기기가 꺼져도 나머지가 영향 없이 동작
- 가족/팀원이 동시에 서로 다른 기기에서 대화 가능

### 클라우드 컨텍스트

- **계층 구조**: 클라우드 베이스 컨텍스트 + 기기별 로컬 오버라이드
- **편집 히스토리**: 컨텍스트 변경 이력을 모두 추적 (누가, 언제, 뭘)
- **디바이스 레지스트리**: 등록된 기기 목록, 온라인 상태, 기기별 역할(capabilities)

### 에이전트 오케스트레이션

- **Heartbeat**: 각 디바이스가 주기적으로 상태 보고 → 클라우드가 전체 상태 파악
- **태스크 큐**: 클라우드에 등록된 태스크를 가용 디바이스에 분배
- **칸반 관리**: 태스크 상태(대기/진행/완료) 추적, 디바이스 간 핸드오프

### 인터페이스

| 인터페이스 | 입력 | 출력 | 로컬 기능 |
|-----------|------|------|----------|
| macOS 앱 | 텍스트, 음성 | TTS, 텍스트, 이미지, 3D | 음성비서, 알람, 미리알림 |
| CLI | 텍스트 | 텍스트 | 스크립팅, 파이프라인 |
| 텔레그램 봇 | 텍스트, 음성메시지 | 텍스트, 이미지 | 모바일 접근 |
| 슬랙 봇 | 텍스트 | 텍스트 | 팀 채널 통합 |

### 3D 아바타

- macOS 앱에서 3D 모델이 대화에 반응 (표정, 제스처)
- 립싱크: TTS 음성과 동기화
- 가족용: 아이들이 캐릭터와 직접 대화하는 경험

## 사용 시나리오

### 가정

- 집 Mac이 항상 켜져서 음성비서로 동작 (웨이크워드, 3D 캐릭터)
- 아이가 "도치야" 하면 캐릭터가 반응하며 대화
- 부모는 외출 중 텔레그램으로 같은 AI에게 질문
- 가족 구성원별 프로필과 기억이 분리되어 있지만 공유 기억도 존재

### 개발

- 업무 Mac에서 CLI로 빠르게 질의
- MCP 서버 연동으로 개발 도구와 통합
- Heartbeat 태스크로 모니터링/알림 자동화
- 집 Mac의 에이전트가 야간 배치 작업 수행

### 업무

- 슬랙 봇으로 팀 채널에서 AI 어시스턴트 활용
- 여러 기기에서 동일한 업무 컨텍스트 유지
- 칸반 태스크 관리로 작업 흐름 자동화
