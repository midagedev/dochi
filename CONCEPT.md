# Dochi - 컨셉 문서

## 이름

"도치"는 고슴도치에서 따왔습니다. 부르기 쉬운 이름이 필요했습니다.

## 핵심 목표

**AI에게 손과 발을 준다.**

ChatGPT에게 "빌드해줘"라고 하면 빌드 명령어를 알려줍니다. Dochi에게 "빌드해줘"라고 하면 진짜로 빌드합니다. "엄마한테 전화해줘"라고 하면 FaceTime이 열립니다. "이 버그 고쳐줘"라고 하면 Claude Code가 코드를 수정합니다.

Dochi의 에이전트는 디바이스에 상주합니다. 텍스트를 주고받는 게 아니라, 내 컴퓨터에서 직접 행동합니다.

## 어떻게 동작하나

### 디바이스를 직접 제어한다

```
"프로젝트 빌드해줘"
→ $ cd ~/repo/myapp && npm run build
→ 빌드 완료. 에러 없음.

"엄마한테 FaceTime 걸어줘"
→ FaceTime 열기 → 엄마 연락처로 통화 시작

"디스크 용량 확인해줘"
→ $ df -h /
→ 256GB 중 180GB 사용. 여유 76GB.
```

bash 실행, 앱 제어, 파일 관리, Apple Shortcuts — macOS가 할 수 있는 건 에이전트도 할 수 있습니다.

| 능력 | 방법 |
|------|------|
| Shell 실행 | bash/zsh 직접 실행 |
| 앱 제어 | open, AppleScript |
| 코딩 에이전트 | Claude Code, OpenCode 세션 관리 |
| 파일 관리 | 읽기/쓰기/검색/정리 |
| Shortcuts | 사용자 정의 자동화 |
| 미리알림/캘린더 | EventKit |
| 스크린샷 | screencapture → LLM 전달 |

### 코딩 에이전트를 부린다

단순히 Claude Code를 여는 게 아닙니다. 세션을 시작하고, 작업을 시키고, 결과를 받아서 요약해줍니다.

```
"코디야, 로그인 API에 rate limit 추가해줘"
→ Claude Code 세션 시작
→ 작업 지시 전달
→ "로그인 엔드포인트에 분당 5회 제한 추가했어요. 테스트도 통과합니다."

"방금 세션 이어서, 회원가입에도 적용해줘"
→ 기존 세션 재개 → 추가 지시 전달

"지금 돌아가는 세션 뭐 있어?"
→ "Claude Code에서 auth 모듈 작업 중이에요."
```

세션을 재개하거나, 여러 세션을 병렬로 돌리거나, CLI 기반 코딩 에이전트라면 무엇이든 연동할 수 있습니다.

### 에이전트마다 성격이 다르다

한 워크스페이스에 여러 에이전트가 공존합니다. 각자 다른 페르소나, 다른 웨이크워드, 다른 권한.

```
"도치야" → 범용 비서. 일정, 미리알림, FaceTime, 친절한 말투
"코디야" → 시니어 개발자. bash, git, Claude Code, 간결한 말투
"키키야" → 아이 대화 친구. 이야기, 교육, bash 접근 차단
```

에이전트를 만드는 건 간단합니다. `system.md` 파일 하나에 페르소나를 적고, 이름과 웨이크워드를 정하면 끝.

**권한은 분리됩니다.** 코디는 bash를 자유롭게 쓸 수 있지만 키키는 쓸 수 없습니다. 위험한 명령은 누가 실행하든 사용자에게 먼저 확인합니다.

### 컨텍스트를 계층으로 관리한다

에이전트가 대화할 때 4개 계층의 컨텍스트가 조합됩니다:

| 계층 | 뭘 담고 있나 | 누가 소유하나 |
|------|------------|-------------|
| 에이전트 지침 | "너는 시니어 개발자 코디야" | 에이전트의 system.md |
| 워크스페이스 기억 | "고양이 나비", "스프린트 3주차" | 워크스페이스 멤버 전체 |
| 에이전트 기억 | "이 프로젝트는 Swift+SwiftUI" | 에이전트가 자동 축적 |
| 개인 컨텍스트 | "커피 좋아함", "알러지: 새우" | 사용자 본인 |

**개인 컨텍스트는 dotfiles 같은 겁니다.** 개발자가 dotfiles를 GitHub에 올려두고 새 머신에서 환경을 복원하듯, 개인 컨텍스트는 클라우드에 동기화됩니다. 새 워크스페이스에 초대받아도, 새 디바이스를 추가해도, AI가 나를 처음부터 알고 있습니다. 내가 직접 편집할 수 있고, 다른 멤버에게 노출되지 않습니다.

### 워크스페이스를 넘나든다

사용자는 여러 워크스페이스를 가집니다. 가족용, 팀용, 사이드 프로젝트용. 하나의 Mac에서 모든 워크스페이스의 에이전트가 동시에 대기합니다.

```
[집 Mac에서]

"도치야, 민수 숙제 도와줘"      → 가족 워크스페이스 · 도치 · 가족 기억
"코디야, PR 리뷰해줘"           → 팀 워크스페이스 · 코디 · 팀 기억
"도치야, 내 알러지 뭐였지?"      → 개인 컨텍스트는 어디서든 동일

→ 웨이크워드가 워크스페이스까지 결정합니다
→ 개인 컨텍스트는 어느 워크스페이스에서든 따라옵니다
```

```
사용자 (아빠)
├── 개인 컨텍스트                ← 모든 WS에서 접근
├── 가족 WS
│   ├── 워크스페이스 기억
│   ├── 도치, 키키
│   └── 디바이스: 집 Mac ──┐
└── 팀 WS                   │    같은 Mac이
    ├── 워크스페이스 기억     │    두 WS에 동시 참여
    ├── 코디               │
    └── 디바이스: 집 Mac ──┘, 업무 Mac
```

## 아키텍처

```
              ┌──────────────────────────────┐
              │     Supabase (동기화 계층)     │
              │  Auth · WS 관리 · 메시지 큐    │
              │  컨텍스트 동기화 · 디바이스 관리  │
              └──────────────┬───────────────┘
                             │
        ┌────────────────────┼────────────────────┐
        │                    │                    │
 ┌──────┴──────┐      ┌─────┴──────┐      ┌─────┴──────┐
 │   집 Mac    │      │  업무 Mac  │      │  메신저 봇  │
 │ [가족+팀 WS]│      │  [팀 WS]  │      │  [팀 WS]  │
 │ 도치·키키·코디│      │   코디    │      │ TG / Slack│
 │ TTS·FaceTime│      │ bash·git  │      │ 피어 메시징 │
 │  Shortcuts  │      │Claude Code│      │           │
 └─────────────┘      └───────────┘      └───────────┘
```

**클라우드는 동기화만.** LLM 호출, 명령 실행, 도구 실행은 전부 디바이스에서 직접.

**디바이스는 독립적.** 한 피어가 꺼져도 나머지에 영향 없습니다. 여러 워크스페이스의 에이전트가 한 디바이스에서 동시에 활성화됩니다.

## 사용 시나리오

### 가정

집 Mac이 항상 켜져 있습니다. 도치와 키키가 상주합니다.

- 아이가 "키키야, 공룡 이야기 해줘" → 키키가 눈높이에 맞춰 대화
- "도치야, 엄마한테 FaceTime 걸어줘" → FaceTime이 열리고 통화 시작
- 부모가 외출 중 텔레그램으로 "밥 먹어!" → 집 Mac에서 도치가 TTS로 아이들에게 전달
- "도치야, 내일 일정 알려줘" → 캘린더 조회 후 음성으로 안내

### 개발

같은 Mac에서 "코디야" 하면 팀 워크스페이스로 전환됩니다.

- "코디야, rate limit 추가해줘" → Claude Code 세션 시작 → 코드 수정 → 결과 요약
- "코디야, 아까 작업 이어서 해줘" → 기존 코딩 세션 재개
- "코디야, 테스트 돌려줘" → 실행 후 결과 요약
- 업무 Mac에서도 같은 팀 컨텍스트로 이어서 작업

## 설계 원칙

1. **로컬 우선** — 실행은 디바이스에서. 클라우드는 동기화만
2. **선언적 에이전트** — `system.md` 하나로 에이전트의 모든 것을 정의
3. **투명** — 오픈소스, 무슨 명령을 실행하는지 항상 보여줌
4. **안전** — 에이전트별 권한 분리, 위험 명령은 반드시 사용자 확인

## 확장 계획

macOS 앱에서 시작하여 CLI, 텔레그램, 슬랙으로 인터페이스를 넓힙니다. 어디서든 같은 에이전트, 같은 기억, 같은 컨텍스트.
